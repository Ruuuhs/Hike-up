# Hike up

<img width="700" alt="スクリーンショット 2020-05-07 0 06 18" src="https://user-images.githubusercontent.com/51771217/110198889-f4ac6680-7e98-11eb-934b-0231632515b9.png">

# 1. サイト概要

スポーツの画像や練習中の動画を共有するサイトです。 <br >

投稿に対して、いいねやブックマークを実装しました。いいねに基づき投稿の週間トレンドを見れます。<br >
また、相互フォローの場合、DM（ダイレクトメッセージ）を送信でき、個人間のやりとりも可能です。

サイト URL<br >
https://hike-up.work <br >
（ゲストユーザーログインボタンから、メールアドレスとパスワードを入力せずにログインできます。）

<img width="350" src= "https://user-images.githubusercontent.com/51771217/110199122-22de7600-7e9a-11eb-8d24-ef2abf3e9dad.png">　<img width="342" src= "https://user-images.githubusercontent.com/51771217/110199164-620cc700-7e9a-11eb-951b-a4d102c6d5e7.png">

## 機能一覧

- ユーザー登録、ログイン機能(devise)
- プロフィール編集
- 投稿機能
  - 画像投稿（AWS の S3 へ保存)
- コメント機能
- いいね機能
  - トレンド機能
- フォロー機能
- DM 機能
- ページネーション機能
  - 無限スクロール
- モーダルウィンドウ
- 処理中のロード機能
- 処理後のフラッシュメッセージ

# 2. 特に見ていただきたい点

## 2-1. インフラ（AWS)の構築

インフラに実際の現場でも積極的に採用されている AWS を選択し、構築しました。

EC2 ではなく、ECS によってサイトを立ち上げました。<br>
開発環境（Docker）で作成したイメージを、ECR で AWS 上にプッシュし、コンテナ管理サービスである ECS を使用する事で、イメージをコンテナ化させました。<br>

ACM と ALB を利用する事で、通信を HTTPS 化しています。

## 2-2. CircleCI により CI／CD 環境を構築し、テストとデプロイを自動化

手動で行う、テストやデプロイの作業を自動化する事で、バグの検出や本番リリース作業などを効率よく行えます。<br>
また、コードの静的解析を自動で行うので、コードの品質を一定に保つことが出来ます。<br>
CD に関しては、Orbs を利用して、ECR への自動プッシュ、ECS への自動デプロイを実行できるようにしました。

## 2-3. フロントエンドの SPA 化

React.js を採用し、SPA 化し UX の向上を行いました。<br>
Redux, hooks を利用し状態管理を行い、非同期処理を実現しました。<br>
MaterialUI を使用し、マテリアルデザインを意識しました。

## 2-4. その他

スクールやメンターなどを使わずに独学で 0 から一人で学び実装しました。<br>
チーム開発を意識し、Github flow に従った開発手法を取り入れました。

# 3. AWS 構成図

<img width="700" alt="スクリーンショット 2020-05-07 11 14 01" src="https://user-images.githubusercontent.com/51771217/110199325-3f2ee280-7e9b-11eb-87e8-0b3b941277c2.png">

# 4. ER 図

entry, room, message は、DM を実装する際に使用しました。<br>
user と room で多対多の関係になる為、中間テーブルとして、entry, message を導入しました。

<img width="700" alt="スクリーンショット 2020-05-07 11 14 01" src="https://user-images.githubusercontent.com/51771217/115104763-87aae700-9f95-11eb-9330-dd4fa06919ea.png">

# 5. 苦労した点

## インフラ（ECS)の構築

ECS を実装している時、コンテナが何度も落ちてしまう、立ち上がっても繋がらない経験をしました。<br>
原因としては、Dockerfile の記述ミス、ECS のポートの設定ミスなどでした。<br>
ECS では、エラーの原因を調べることが難しく、そもそもネットワークの知識が少なかった為、どこでどういったエラーが起きているのかが分かりませんでした。

## Docker の使用

Docker でフロントとバックエンド、DB をそれぞれ分けているので、それらを繋ぐのに苦労しました。<br>
AWS と同様、ネットワークの知識が乏しい為、それぞれが繋がりの仕組みが分からず、原因を探るのに時間がかかりました。

## SPA 化

フロントエンドに React を使用する事で、Rails でデザインの部分の記述が複雑になりました。<br>
SPA 化するのに、Redux, hooks による状態管理を理解し実装に手間取りましたが、コンポーネント間のデータの管理はうまく対応できるようになりました。

# 6. 使用技術

- フロントエンド
  - React.js : 17.0.1
- バックエンド
  - Ruby : 2.6.6
  - Ruby on Rails : 6.0.3.4
- データベース
  - MySQL : 5.7
- インフラ
  - AWS(ECS(Fargate)、ECR、RDS,S3、ALB、Route53、IAM、ACM、SystemManager）
- その他
  - Docker/Doker-compose
  - CircleCI：2.1（CI/CD)
